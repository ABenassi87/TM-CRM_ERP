<script type="text/ng-template" id="searchsupplierproduct.html">
    <a>
        <span ng-bind-html="match.model.ref | typeaheadHighlight:query"></span> - <span ng-bind-html="match.model.info.langs[0].name"></span> ({{match.model.directCost |currency}})
    </a>
</script>
<div class="row">
    <div class="col-md-12">
        <div ng-if="product.type == 'PACK' && product.prices.pu_ht < product.total_pack" class="alert alert-warning"><strong>@(Warning) !</strong> @(products:LowerPrice)</div>

        <div class="form-horizontal form-row-seperated">
            <div class="portlet portlet light bordered">
                <div class="portlet-title">
                    <div class="caption font-yellow-crusta">
                        <i class="fa fa-cubes font-yellow-crusta sbold"></i> @(products:Bundle)
                    </div>
                    <div class="actions btn-set">
                        <a class="btn btn-circle btn-outline sbold uppercase red" ui-sref="product.list"><i class="fa fa-angle-left"></i> @(Back)</a>
                        <button type="button" ng-click="update(true)" class="btn btn-circle btn-outline sbold uppercase green"><i class="fa fa-check"></i> @(Save)</button>
                        <button type="button" ng-click="update()" class="btn btn-circle btn-outline sbold uppercase green"><i class="fa fa-check-circle"></i> @(SaveAndContinueEdit)</button>
                        <div class="btn-group">
                            <a class="btn btn-circle dark btn-outline sbold uppercase dropdown-toggle" href="javascript:;" data-toggle="dropdown">
                                <i class="fa fa-share"></i> @(Tools) <i class="fa fa-angle-down"></i>
                            </a>
                            <ul class="dropdown-menu pull-right">
                                <li>
                                    <a href="#" ng-click="clone()">
                                        <i class="fa fa-copy"></i> @(ToClone)
                                    </a>
                                </li>
                                <li class="divider">
                                </li>
                                <li>
                                    <a href="#" class="font-red" ng-show="login.rights.product.delete" confirmed-click="remove(product)" ng-confirm-click="Supprimer le produit ?" title="Supprimer le produit">
                                        <i class="fa fa-trash-o font-red"></i> @(Delete)
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12">

                            <table class="table table-bordered table-hover">
                                <thead>
                                    <tr role="row" class="heading">
                                        <th>
                                            @(products:Ref)
                                        </th>
                                        <th>
                                            @(Label)
                                        </th>
                                        <th>
                                            @(Qty)
                                        </th>
                                        <th>
                                            @(products:BuyingPriceHT)
                                        </th>
                                        <th>
                                            @(AmountHT)
                                        </th>
                                        <th>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <input class="form-control" ng-model="newPack.id.name" typeahead="product as product.name for product in productAutoComplete($viewValue, 'name')" typeahead-template-url="searchsupplierproduct.html" typeahead-on-select="addPackProduct($item)" placeholder="@(products:ProductRef)"
                                            />
                                        </td>
                                        <td>
                                            {{newPack.id.name}}
                                        </td>
                                        <td>
                                            <input class="form-control" type="number" min="0" step="any" ng-model="newPack.qty" ng-change="changePackQty()" />
                                        </td>
                                        <td>
                                            {{newPack.directCost|currency}}
                                        </td>
                                        <td>
                                            {{newPack.total_ht|currency}}
                                        </td>
                                        <td>
                                            <button class="btn btn-circle default" ng-click="addPack()">
                                                <i class="fa fa-plus"></i></button>
                                        </td>
                                    </tr>
                                    <tr ng-repeat="pack in product.pack">
                                        <td>
                                            <a class="with-tooltip" ui-sref="product.show({id: pack.id._id})" data-tooltip-options='{"position":"top"}' title="{{pack.id.info.SKU}}"><span class="fa fa-cubes"></span> {{pack.id.info.SKU}}</a>
                                        </td>
                                        <td>
                                            {{pack.id.info.langs[0].name}}
                                        </td>
                                        <td>
                                            <span editable-number="pack.qty" e-min="0" e-step="any" onaftersave="update()">
                                                {{pack.qty}}
                                            </span>
                                        </td>
                                        <td style="text-align: right; ">
                                            {{pack.id.directCost| currency}}
                                        </td>
                                        <td style="text-align: right; ">
                                            {{pack.id.directCost * pack.qty| currency}}
                                        </td>
                                        <td>
                                            <button class="btn btn-circle red" ng-click="deletePack($index)">
                                                <i class="fa fa-trash"></i> </button>
                                        </td>
                                    </tr>
                                </tbody>

                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>